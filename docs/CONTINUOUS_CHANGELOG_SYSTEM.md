# Continuous Git Changelog System

## Overview

The Continuous Git Changelog System automatically converts Git commits into application changelog entries in real-time. Unlike the manual Git changelog generation, this system runs continuously in the background, ensuring that every commit becomes a changelog entry immediately.

## ðŸ”„ How It Works

```
Git Commit â†’ Background Service (5min) â†’ Changelog Entry â†’ Appears in App
     â†“              â†“                        â†“              â†“
  feat: add X   Categorization         "Add X" entry    User sees it
```

## âœ… Implementation Complete

All 4 requested components have been implemented:

### 1. âœ… Background Service (Scheduled Processing)
- **Frequency**: Every 5 minutes
- **Location**: `packages/backend/src/services/scheduledJobs.ts`
- **Function**: Automatically processes new Git commits
- **Integration**: Added to existing job scheduler

### 2. âœ… Auto-Changelog Service (Continuous Processing)
- **Service**: `AutoChangelogService`
- **Location**: `packages/backend/src/services/autoChangelogService.ts`
- **Features**:
  - Processes new commits since last run
  - Creates "Unreleased" changelog automatically
  - Categorizes commits intelligently
  - Stores entries in existing changelog system

### 3. âœ… Real-time Integration (API Endpoints)
- **New Endpoints**:
  - `POST /api/git-changelogs/admin/auto-process` - Manual trigger
  - `GET /api/git-changelogs/admin/auto-stats` - Processing statistics
  - `POST /api/git-changelogs/admin/create-version` - Create versioned release
- **Integration**: Works with existing changelog UI

### 4. âœ… Webhook Integration (Immediate Processing)
- **Supported**: GitHub, GitLab, Generic Git providers
- **Location**: `packages/backend/src/routes/gitWebhooks.ts`
- **Security**: Signature/token verification
- **Trigger**: Immediate processing on Git push

## ðŸš€ Quick Start

### Setup the System
```bash
# 1. Run the setup script
cd packages/backend
npx tsx src/scripts/setupContinuousChangelog.ts

# 2. Test the workflow
npx tsx src/scripts/setupContinuousChangelog.ts test-workflow

# 3. Test webhook integration
npx tsx src/scripts/setupContinuousChangelog.ts test-webhooks
```

### Environment Variables (Optional)
```bash
# For webhook security
GITHUB_WEBHOOK_SECRET=your-github-secret
GITLAB_WEBHOOK_TOKEN=your-gitlab-token
GENERIC_WEBHOOK_SECRET=your-generic-secret
```

## ðŸ“Š System Behavior

### Automatic Processing
1. **Every 5 minutes**: Background service checks for new commits
2. **New commits found**: Automatically categorized and processed
3. **Public commits**: Added to "Unreleased" changelog as entries
4. **Private commits**: Stored but not shown in public changelog
5. **Immediate visibility**: Entries appear in your changelog UI

### "Unreleased" Changelog
- **Auto-created**: System creates "Unreleased" changelog automatically
- **Continuous updates**: New commits are added as entries
- **Always visible**: Published and visible to users
- **Version creation**: Can be converted to versioned release

### Commit Categorization
- **Conventional commits**: `feat:`, `fix:`, `perf:`, etc.
- **Smart filtering**: Excludes `chore:`, `docs:`, `test:` from public
- **Breaking changes**: Detected automatically
- **Custom rules**: Configurable via database

## ðŸ”— API Usage

### Manual Processing
```bash
# Trigger immediate processing
curl -X POST "http://localhost:3000/api/git-changelogs/admin/auto-process" \
  -H "Authorization: Bearer YOUR_TOKEN"
```

### Get Statistics
```bash
# Check processing stats
curl -X GET "http://localhost:3000/api/git-changelogs/admin/auto-stats" \
  -H "Authorization: Bearer YOUR_TOKEN"
```

### Create Version Release
```bash
# Convert unreleased entries to versioned changelog
curl -X POST "http://localhost:3000/api/git-changelogs/admin/create-version" \
  -H "Authorization: Bearer YOUR_TOKEN" \
  -H "Content-Type: application/json" \
  -d '{"version": "v1.2.0", "title": "Release 1.2.0"}'
```

## ðŸ”” Webhook Setup

### GitHub Webhook
1. Go to your repository settings â†’ Webhooks
2. Add webhook:
   - **URL**: `https://your-domain.com/api/git-webhooks/github`
   - **Content type**: `application/json`
   - **Secret**: Set `GITHUB_WEBHOOK_SECRET` environment variable
   - **Events**: Just the push event

### GitLab Webhook
1. Go to your project settings â†’ Webhooks
2. Add webhook:
   - **URL**: `https://your-domain.com/api/git-webhooks/gitlab`
   - **Secret token**: Set `GITLAB_WEBHOOK_TOKEN` environment variable
   - **Trigger**: Push events

### Test Webhook
```bash
# Test webhook processing
curl -X POST "http://localhost:3000/api/git-webhooks/test"
```

## ðŸ“± Frontend Integration

The system integrates seamlessly with your existing changelog UI:

### Existing Changelog Display
- **No changes needed**: Uses existing `changelogs` and `changelog_entries` tables
- **Auto-generated flag**: Entries have `isAutoGenerated: true`
- **Git commit link**: Entries have `gitCommitHash` for traceability
- **Mixed content**: Manual and auto-generated entries coexist

### Real-time Updates
- **Immediate visibility**: New commits appear in changelog within 5 minutes
- **"Unreleased" section**: Always shows latest development changes
- **Version releases**: Convert unreleased entries to proper releases

## ðŸ”„ Workflow Examples

### Daily Development Workflow
```bash
# Developer makes commits
git commit -m "feat: add user profile page"
git commit -m "fix: resolve login issue"
git push

# Within 5 minutes (or immediately with webhook):
# - Commits are processed automatically
# - "Add user profile page" appears in "Unreleased" changelog
# - "Resolve login issue" appears in "Unreleased" changelog
# - Users can see latest changes immediately
```

### Release Workflow
```bash
# When ready to release
curl -X POST "/api/git-changelogs/admin/create-version" \
  -d '{"version": "v1.2.0", "title": "Release 1.2.0"}'

# Result:
# - Creates "Release 1.2.0" changelog
# - Moves all unreleased entries to the new version
# - Clears "Unreleased" changelog for next development cycle
```

## ðŸ“Š Monitoring

### Processing Statistics
```javascript
// Get current stats
const stats = await fetch('/api/git-changelogs/admin/auto-stats');
console.log(stats);
// {
//   totalCommitsTracked: 150,
//   publicCommitsTracked: 89,
//   autoGeneratedEntries: 89,
//   unreleasedEntries: 12,
//   lastProcessedCommit: { ... }
// }
```

### Health Monitoring
```bash
# Check system health
curl -X GET "http://localhost:3000/api/git-webhooks/health"
```

## ðŸŽ¯ Benefits

### For Developers
- **Zero effort**: Commits automatically become changelog entries
- **No manual work**: No need to write changelog entries manually
- **Immediate feedback**: See changes reflected immediately
- **Conventional commits**: Encourages good commit message practices

### For Users
- **Always up-to-date**: Changelog always reflects latest changes
- **Real-time visibility**: See what's being worked on
- **Professional presentation**: Well-formatted, categorized entries
- **Release tracking**: Clear version history

### For Project Management
- **Automatic documentation**: Changes are documented automatically
- **Release preparation**: Easy to create releases from unreleased changes
- **Change tracking**: Full history of all changes
- **Transparency**: Users always know what's happening

## ðŸ”§ Customization

### Commit Filtering
Modify filtering rules in the `commit_filters` database table:
```sql
INSERT INTO commit_filters (name, pattern, filter_type, priority)
VALUES ('Exclude WIP', '^(wip|WIP):', 'exclude', 50);
```

### Categorization Rules
Add custom categorization in `CommitCategorizationService`:
```typescript
// Custom rules for your project
const customRules = [
  { pattern: /^ui:/, category: 'improvement', isPublic: true, priority: 85 },
  { pattern: /^api:/, category: 'feature', isPublic: true, priority: 84 },
];
```

### Processing Frequency
Modify the scheduled job interval in `scheduledJobs.ts`:
```typescript
// Change from 5 minutes to 2 minutes
this.scheduleJob('auto-changelog-processing', async () => {
  // ...
}, 2 * 60 * 1000); // 2 minutes
```

## âœ… System Status

The continuous Git changelog system is **fully implemented and ready to use**:

- âœ… **Background processing**: Every 5 minutes
- âœ… **Auto-changelog service**: Processes commits continuously  
- âœ… **Real-time integration**: API endpoints active
- âœ… **Webhook support**: GitHub, GitLab, Generic
- âœ… **Database integration**: Uses existing changelog tables
- âœ… **UI compatibility**: Works with existing changelog display
- âœ… **Documentation**: Complete setup and usage guides
- âœ… **Testing**: Comprehensive test scripts provided

**Your Git commits now automatically become changelog entries!** ðŸŽ‰
